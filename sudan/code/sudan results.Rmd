---
title: "afrobarometer Sudan"
output:
  pdf_document: default
  html_document: default
date: "2024-05-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
library(haven)
library(stringr)
```

# Sudan

all warnings can be ignored

```{r}
r5 = read_sav("/Users/andyouyang/Documents/research/sudan/data/afrobarometer_sud_r5_2013.sav")
r6 = read_sav("/Users/andyouyang/Documents/research/sudan/data/afrobarometer_sud_r6_2015.sav")
r7 = read_sav("/Users/andyouyang/Documents/research/sudan/data/afrobarometer_sud_r7_2018.sav")
r8 = read_sav("/Users/andyouyang/Documents/research/sudan/data/afrobarometer_sud_r8_2021.sav")
r9 = read_sav("/Users/andyouyang/Documents/research/sudan/data/afrobarometer_sud_r9_2022.sav")
```

# Over Time

## reject one party rule, military rule, one man rule
```{r}
# get rid of refused, dont know, missing
r9_dupe <- subset(r9, !Q22A %in% c(8,9,-1))
r9_dupe <- subset(r9, !Q22B %in% c(8,9,-1))
r9_dupe <- subset(r9, !Q22C %in% c(8,9,-1))

r8_dupe <- subset(r8, !Q20A %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q20B %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q20C %in% c(8,9,-1))

r7_dupe <- subset(r7, !Q27A %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q27B %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q27C %in% c(8,9,-1))

r6_dupe <- subset(r6, !Q28A %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q28B %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q28C %in% c(8,9,-1))

r5_dupe <- subset(r5, !Q31A %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q31B %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q31C %in% c(8,9,-1))


rejone_bk <- c(mean(r5_dupe$Q31A), mean(r6_dupe$Q28A), 
               mean(r7_dupe$Q27A), mean(r8_dupe$Q20A), mean(r9_dupe$Q22A))
rejmil_bk <- c(mean(r5_dupe$Q31B), mean(r6_dupe$Q28B), 
               mean(r7_dupe$Q27B), mean(r8_dupe$Q20B), mean(r9_dupe$Q22B))
rejdic_bk <- c(mean(r5_dupe$Q31C), mean(r6_dupe$Q28C), 
               mean(r7_dupe$Q27C), mean(r8_dupe$Q20C), mean(r9_dupe$Q22C))
years <- c("Round 5 (2012)", "Round 6 (2015)", "Round 7 (2018)", "Round 8 (2021)", "Round 9 (2022)")

rejone_df <- data.frame(Year = years, AverageResponse = rejone_bk)
rejone_df %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "sienna1") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Approval to One Party Rule Over Time in Sudan",
       subtitle = "The y-axis scale is as follows: 1 is strongly disapprove, 2 is disapprove, 3 is neither, \n 4 is appprove, 5 is strongly approve")
rejmil_df <- data.frame(Year = years, AverageResponse = rejmil_bk)
rejmil_df %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "sienna1") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Approval to Military Rule Over Time in Sudan",
       subtitle = "The y-axis scale is as follows: 1 is strongly disapprove, 2 is disapprove, 3 is neither, \n 4 is appprove, 5 is strongly approve")
rejdic_df <- data.frame(Year = years, AverageResponse = rejdic_bk)
rejdic_df %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "sienna1") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Approval to One Man Rule Over Time in Sudan",
       subtitle = "The y-axis scale is as follows: 1 is strongly disapprove, 2 is disapprove, 3 is neither, \n 4 is appprove, 5 is strongly approve")
```

## support for democracy, extent of democracy, and satisfaction of democracy

```{r}
r9_dupe <- subset(r9, !Q23 %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q21 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q28 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q30 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q32 %in% c(8,9,-1))

support <- c(mean(r5_dupe$Q32), mean(r6_dupe$Q30), 
             mean(r7_dupe$Q28), mean(r8_dupe$Q21), mean(r9_dupe$Q23))
data.frame(Year = years, AverageResponse = support) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Support for Democracy Over Time in Sudan",
       subtitle = "The y-axis scale is as follows: 1 is does not matter, 2 is sometimes non-democratic preferable, \n3 is democracy preferable")
  
```



```{r}
r9_dupe <- subset(r9, !Q30 %in% c(8,9,98,-1))
r8_dupe <- subset(r8, !Q36 %in% c(8,9,98,-1))
r7_dupe <- subset(r7, !Q35 %in% c(8,9,98,-1))
r6_dupe <- subset(r6, !Q40 %in% c(8,9,98,-1))
r5_dupe <- subset(r5, !Q42 %in% c(8,9,98,-1))

extent <- c(mean(r5_dupe$Q42), mean(r6_dupe$Q40), 
             mean(r7_dupe$Q35), mean(r8_dupe$Q36), mean(r9_dupe$Q30))
data.frame(Year = years, AverageResponse = extent) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Extent of Democracy Over Time in Sudan",
       subtitle = "The y-axis scale is as follows: 1 is not a democracy, 2 is a democracy with major problems, \n3 is democracy with minor problems, 4 is full democracy")
```

```{r}
r9_dupe <- subset(r9, !Q31 %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q37 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q36 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q41 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q43 %in% c(8,9,-1))

satisfaction <- c(mean(r5_dupe$Q43), mean(r6_dupe$Q41), 
             mean(r7_dupe$Q36), mean(r8_dupe$Q37), mean(r9_dupe$Q31))
data.frame(Year = years, AverageResponse = satisfaction) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Satisfaction for Democracy Over Time in Sudan",
       subtitle = "The y-axis scale is as follows: 0 is not a democracy, 1 is not at all satisfied, 2 is not very satisfied, \n3 is fairly satified, 4 is very satisfied")

```


## Govt gets things done vs. Govt accountable to citizens

```{r}
r9_dupe <- subset(r9, !Q18 %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q22 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q29 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q31 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q33 %in% c(8,9,-1))
# r4_dupe <- subset(r4, !Q43 %in% c(8,9,-1)) # question not in wave 4

recode_statements <- function(data, col, recode_rules) {
  data[[col]] <- factor(data[[col]])
  data[[col]] <- fct_recode(data[[col]], !!!recode_rules)
  data[[col]] <- as.numeric(as.character(data[[col]]))
  return(data)
}

# adjustment made to ordering
# final ordering is as follows
# 1 - strongly agree with statement 1
# 2 - agree with statement 1
# 3 - agree with neither (neutral)
# 4 - agree with statement 2
# 5 - strongly agree with statement 2

statement_rules <- list(
  "1" = "1",
  "2" = "2",
  "4" = "3",
  "5" = "4",
  "3" = "5",
  "8" = "8",
  "9" = "9",
  "-1" = "-1")

r9_dupe <- recode_statements(r9_dupe, "Q18", statement_rules)
r8_dupe <- recode_statements(r8_dupe, "Q22", statement_rules)
r7_dupe <- recode_statements(r7_dupe, "Q29", statement_rules)
r6_dupe <- recode_statements(r6_dupe, "Q31", statement_rules)
r5_dupe <- recode_statements(r5_dupe, "Q33", statement_rules)


# subtitle = "Full Question: Question: Which of the following statements is closest to your view? \nStatement 1: It is more important to have a government that can get things done, even if we \nhave no influence over what it does. \nStatement 2: It is more important for citizens to be able to hold government accountable, even \nif that means it makes decisions more slowly."

govt <- c(mean(r5_dupe$Q33), mean(r6_dupe$Q31), 
          mean(r7_dupe$Q29), mean(r8_dupe$Q22), mean(r9_dupe$Q18))
govt

data.frame(Year = c("Round 5 (2012)", "Round 6 (2015)", "Round 7 (2018)", "Round 8 (2021)", "Round 9 (2022)"), AverageResponse = govt) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "seagreen") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to government gets things done (Statement 1) vs. \naccountable to citizens (Statement 2) Over Time in Sudan",
       subtitle = "The y-axis scale is as follows: 1 is strongly agree with statement 1, 2 is agree with statement 1, \n3 is agree with neither, 4 is agree with statement 2, 5 is strongly agree with statement 2")

```

## Choose leaders through elections vs. other methods

```{r}
r9_dupe <- subset(r9, !Q24 %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q24 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q30 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q32 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q34 %in% c(8,9,-1))

recode_statements <- function(data, col, recode_rules) {
  data[[col]] <- factor(data[[col]])
  data[[col]] <- fct_recode(data[[col]], !!!recode_rules)
  data[[col]] <- as.numeric(as.character(data[[col]]))
  return(data)
}

# same adjustment made to ordering as prior graph

statement_rules <- list(
  "1" = "1",
  "2" = "2",
  "4" = "3",
  "5" = "4",
  "3" = "5",
  "8" = "8",
  "9" = "9",
  "-1" = "-1")

r9_dupe <- recode_statements(r9_dupe, "Q24", statement_rules)
r8_dupe <- recode_statements(r8_dupe, "Q24", statement_rules)
r7_dupe <- recode_statements(r7_dupe, "Q30", statement_rules)
r6_dupe <- recode_statements(r6_dupe, "Q32", statement_rules)
r5_dupe <- recode_statements(r5_dupe, "Q34", statement_rules)

govt <- c(mean(r5_dupe$Q34), mean(r6_dupe$Q32), 
          mean(r7_dupe$Q30), mean(r8_dupe$Q24), mean(r9_dupe$Q24))
govt

data.frame(Year = years, AverageResponse = govt) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "seagreen") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Choose leaders through elections (Statement 1) \nvs other methods (Statement 2) Over Time in Sudan",
       subtitle = "The y-axis scale is as follows: 1 is strongly agree with statement 1, 2 is agree with statement 1, \n3 is agree with neither, 4 is agree with statement 2, 5 is strongly agree with statement 2")
```

## performance of president, trust president

```{r}
r9_dupe <- subset(r9, !Q47A %in% c(8,9,-1)) 
r8_dupe <- subset(r8, !Q51A %in% c(8,9,-1)) # 1 2 3 4 
r7_dupe <- subset(r7, !Q58A %in% c(8,9,-1)) # 1 2 3 4 
r6_dupe <- subset(r6, !Q68A %in% c(8,9,-1)) # 1 2 3 4 
r5_dupe <- subset(r5, !Q71A %in% c(8,9,-1)) # 1 2 3 4 


# 1=Strongly disapprove, 2=Disapprove, 3=Approve, 4=Strongly approve

perf <- c(mean(r5_dupe$Q71A), mean(r6_dupe$Q68A), 
            mean(r7_dupe$Q58A), mean(r8_dupe$Q51A), mean(r9_dupe$Q47A))

print(perf)

table(r9_dupe$Q47A)
data.frame(Year = years, AverageResponse = perf) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Performance of President in Burkina Faso Over Time",
       subtitle = "The y-axis scale is as follows: 1 is strongly disapprove, 2 is disapprove, 3 is approve,\n4 is strongly approve")
```

```{r}
r9_dupe <- subset(r9, !Q37A %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q41A %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q43A %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q52A %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q59A %in% c(8,9,-1))


trust <- c(mean(r5_dupe$Q59A), mean(r6_dupe$Q52A), 
             mean(r7_dupe$Q43A), mean(r8_dupe$Q41A), mean(r9_dupe$Q37A))
data.frame(Year = years, AverageResponse = trust) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Trust in President in Burkina Faso Over Time",
       subtitle = "The y-axis scale is as follows: 0 is not at all, 1 is just a little, 2 is somewhat, 3 is a lot")
```

## voted in last election

```{r}
r9_dupe <- subset(r9, !Q13 %in% c(8,9,-1)) 
r8_dupe <- subset(r8, !Q13 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q22 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q21 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q27 %in% c(8,9,-1))

perf <- c(
           sum(r5_dupe$Q27 == 1) / length(r5_dupe$Q27), 
           sum(r6_dupe$Q21 == 1) / length(r6_dupe$Q21), sum(r7_dupe$Q22 == 1) / length(r7_dupe$Q22), 
           sum(r8_dupe$Q13 == 3) / length(r8_dupe$Q13), sum(r9_dupe$Q13 == 3) / length(r9_dupe$Q13))

data.frame(Year = years, AverageResponse = perf) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Percentage of People",
       title = "Percentage of People Who Voted in the Last Election in Burkina Faso Over Time")

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/over time/voted in last election over time.png", bg = "white", dpi=700))

```

# Most Recent Round, Wave 9 (2022)

## reject one party rule, military rule, one man rule
```{r, warning = FALSE}

# 1 = Strongly disapprove, 2 = Disapprove, 3 = Neither approve nor disapprove, 4 = Approve,
# 5 = Strongly approve, 8 = Refused, 9 = Don’t know, -1 = Missing

r9$Q22A <- factor(r9$Q22A)
r9$Q22B <- factor(r9$Q22B)
r9$Q22C <- factor(r9$Q22C)

r9$Q22A <- fct_recode(r9$Q22A, 
             "Strongly disapprove" = "1", 
             "Disapprove" = "2", 
             "Neither approve nor disapprove" = "3", 
             "Approve" = "4",
             "Strongly approve" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

r9$Q22B <- fct_recode(r9$Q22B,
             "Strongly disapprove" = "1", 
             "Disapprove" = "2", 
             "Neither approve nor disapprove" = "3", 
             "Approve" = "4",
             "Strongly approve" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

r9$Q22C <- fct_recode(r9$Q22C, 
             "Strongly disapprove" = "1", 
             "Disapprove" = "2", 
             "Neither approve nor disapprove" = "3", 
             "Approve" = "4",
             "Strongly approve" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q22A %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q22A)) +
  geom_bar(fill = "coral") +
  labs(x = "Scale of Approval",
       y = "Number of Responses",
       title = "Distribution of Responses to Approving/Disapproving One Party Rule in \nSudan 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/one party rule.png", bg = "white", dpi=700))

subset(r9, !Q22B %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q22B)) +
  geom_bar(fill = "coral") +
  labs(x = "Scale of Approval",
       y = "Number of Responses",
       title = "Distribution of Responses to Approving/Disapproving Military Rule in \nSudan 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/military rule.png", bg = "white", dpi=700))


subset(r9, !Q22C %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q22C)) +
  geom_bar(fill = "coral") +
  labs(x = "Scale of Approval",
       y = "Number of Responses",
       title = "Distribution of Responses to Approving/Disapproving One Man Rule in \nSudan 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/one man rule.png", bg = "white", dpi=700))

```

## support for democracy, extent of democracy, and satisfaction of democracy

```{r}
r9$Q23 <- factor(r9$Q23)
unique(r9$Q23)

r9$Q23 <- fct_recode(r9$Q23, 
             "Doesn’t matter" = "1", 
             "Sometimes non-democratic preferable" = "2", 
             "Democracy preferable" = "3", 
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q23 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q23)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Support for Democracy",
       y = "Number of Responses",
       title = "Distribution of Responses Towards Supporting Democracy in \nSudan 2022")

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/democracy support.png", bg = "white", dpi=700))

```

             
```{r}
r9$Q30 <- factor(r9$Q30)
unique(r9$Q30)

r9$Q30 <- fct_recode(r9$Q30,
             "Not a democracy" = "1",
             "Democracy, with major problems" = "2",
             "Democracy, but with minor problems" = "3",
             "Full democracy" = "4",
             "Do not understand question/what democracy is" = "8",
             "Don't Know" = "9",
             "Refused" = "98",
             "Missing" = "-1")

subset(r9, !Q30 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q30)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Support for Democracy",
       y = "Number of Responses",
       title = "Distribution of Responses to the Extent of Democracy in Sudan 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/democracy extent.png", bg = "white", dpi=700))


```

```{r}
r9$Q31 <- factor(r9$Q31)
unique(r9$Q31)

r9$Q31 <- fct_recode(r9$Q31,
             "Not a democracy" = "0",
             "Not at all satisfied" = "1",
             "Not very satisfied" = "2",
             "Fairly satisfied" = "3",
             "Very satisfied" = "4",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q31 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q31)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Satisfaction of Democracy",
       y = "Number of Responses",
       title = "Distribution of Responses to Satisfaction of Democracy in Sudan 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

# 0= not a democracy, 1=Not at all satisfied, 2=Not very satisfied, 3=Fairly satisfied,
# 4=Very satisfied, 8=Refused, 9=Don’t know, -1=Missing

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/democracy satisfaction.png", bg = "white", dpi=700))

```

## Govt gets things done vs. Govt accountable to citizens

```{r}

r9$Q18 <- factor(r9$Q18)
unique(r9$Q18)

r9$Q18 <- fct_recode(r9$Q18,
             "Strongly agree with Statement 1" = "1", 
             "Agree with Statement 1" = "2", 
             "Agree with Statement 2" = "3",
             "Strongly agree with Statement 2" = "4",
             "Agree with neither" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q18 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q18)) +
  geom_bar(fill = "forestgreen") +
  labs(x = "Agreement to Statements",
       y = "Number of Responses",
       title = "Distribution of Responses to government gets things done (Statement 1) vs. \naccountable to citizens (Statement 2) in Sudan 2022",
       subtitle = "Full Question: Question: Which of the following statements is closest to your view? \nStatement 1: It is more important to have a government that can get things done, even if we \nhave no influence over what it does. \nStatement 2: It is more important for citizens to be able to hold government accountable, even \nif that means it makes decisions more slowly.") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 


# 1=Strongly agree with Statement 1, 2=Agree with Statement 1, 3=Agree with Statement 2,
# 4=Strongly agree with Statement 2, 5=Agree with neither, 8=Refused, 9=Don’t know, -1=Missing
suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/govt.png", bg = "white", dpi=700))

```

## Choose leaders through elections vs. other methods

```{r}
r9$Q24 <- factor(r9$Q24)
unique(r9$Q24)

r9$Q24 <- fct_recode(r9$Q24,
             "Strongly agree with Statement 1" = "1", 
             "Agree with Statement 1" = "2", 
             "Agree with Statement 2" = "3",
             "Strongly agree with Statement 2" = "4",
             "Agree with neither" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q24 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q24)) +
  geom_bar(fill = "forestgreen") +
  labs(x = "Agreement to Statements",
       y = "Number of Responses",
       title = "Distribution of Responses to Choose leaders through elections (Statement 1) \nvs other methods (Statement 2) in Sudan 2022",
       subtitle = "Which of the following statements is closest to your view? \nStatement 1: We should choose our leaders in this country through regular, open and honest \nelections. \nStatement 2: Since elections sometimes produce bad results, we should adopt other methods for \nchoosing this country’s leaders.") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/leaders.png", bg = "white", dpi=700))

```

## performance of president 

```{r}
r9$Q47A <- factor(r9$Q47A)

r9$Q47A <- fct_recode(r9$Q47A,
             "Strongly disapprove" = "1", 
             "Disapprove" = "2", 
             "Approve" = "3",
             "Strongly approve" = "4",
             "Refused" = "8",
             "Don’t know/Haven’t heard enough" = "9",
             "Missing" = "-1")

subset(r9, !Q47A %in% c("Refused", "Don’t know/Haven’t heard enough", "Missing")) %>%
  ggplot(aes(x = Q47A)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Performance of President",
       y = "Number of Responses",
       title = "Distribution of Responses to Performance of President in Sudan 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/president performance.png", bg = "white", dpi=700))

```

## trust in president 

```{r}
r9$Q37A <- factor(r9$Q37A)

# 0=Not at all, 1=Just a little, 2=Somewhat, 3=A lot

r9$Q37A <- fct_recode(r9$Q37A,
             "Not at all" = "0",
             "Just a little" = "1",
             "Somewhat" = "2",
             "A lot" = "3",
             "Refused" = "8",
             "Don’t know/Haven’t heard enough" = "9",
             "Missing" = "-1")

subset(r9, !Q37A %in% c("Refused", "Don’t know/Haven’t heard enough", "Missing")) %>%
  ggplot(aes(x = Q37A)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Trust in President",
       y = "Number of Responses",
       title = "Distribution of Responses to Trust in President in Sudan 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/president trust.png", bg = "white", dpi=700))

```

## voted in last election

```{r}
r9$Q13 <- factor(r9$Q13)

r9$Q13 <- fct_recode(r9$Q13,
             "I did not vote" = "0",
             "I was too young to vote" = "1",
             "I can’t remember whether I voted" = "2",
             "I voted in the election" = "3",
             "Refused" = "8",
             "Don’t know" = "9",
             "Missing" = "-1")

subset(r9, !Q13 %in% c("Refused", "Don’t know", "Missing")) %>%
  ggplot(aes(x = Q13)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Trust in President",
       y = "Number of Responses",
       title = "Distribution of Responses to Voted in Last Election in Sudan 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("/Users/andyouyang/Documents/research/sudan/most recent/voted in last election.png", bg = "white", dpi=700))

```
