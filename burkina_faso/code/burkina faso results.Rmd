---
title: "afrobarometer burkina faso"
output:
  pdf_document: default
  html_document: default
date: "2024-05-22"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(forcats)
library(haven)
library(stringr)
```

# Burkina Faso

all warnings can be ignored

```{r}
r4 = read_sav("/Users/andyouyang/Documents/research/burkina_faso/data/afrobarometer_bfo_r4_2008.sav")
r5 = read_sav("/Users/andyouyang/Documents/research/burkina_faso/data/afrobarometer_bfo_r5_2012.sav")
r6 = read_sav("/Users/andyouyang/Documents/research/burkina_faso/data/afrobarometer_bfo_r6_2015.sav")
r7 = read_sav("/Users/andyouyang/Documents/research/burkina_faso/data/afrobarometer_bfo_r7_2018.sav")
r8 = read_sav("/Users/andyouyang/Documents/research/burkina_faso/data/afrobarometer_bfo_r8_2021.sav")
r9 = read_sav("/Users/andyouyang/Documents/research/burkina_faso/data/afrobarometer_bfo_r9_2022.sav")

years <- c("Round 4 (2008)", "Round 5 (2012)", "Round 6 (2015)", "Round 7 (2018)", "Round 8 (2021)", "Round 9 (2022)")
# change the year
```

# Over Time

## reject one party rule, military rule, one man rule
```{r}
# get rid of refused, dont know, missing
r9_dupe <- subset(r9, !Q22A %in% c(8,9,-1))
r9_dupe <- subset(r9, !Q22B %in% c(8,9,-1))
r9_dupe <- subset(r9, !Q22C %in% c(8,9,-1))

r8_dupe <- subset(r8, !Q20A %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q20B %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q20C %in% c(8,9,-1))

r7_dupe <- subset(r7, !Q27A %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q27B %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q27C %in% c(8,9,-1))

r6_dupe <- subset(r6, !Q28A %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q28B %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q28C %in% c(8,9,-1))

r5_dupe <- subset(r5, !Q31A %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q31B %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q31C %in% c(8,9,-1))

r4_dupe <- subset(r4, !Q29A %in% c(8,9,-1))
r4_dupe <- subset(r4, !Q29B %in% c(8,9,-1))
r4_dupe <- subset(r4, !Q29C %in% c(8,9,-1))

# r3_dupe <- subset(r3, !Q36A %in% c(8,9,-1))
# r3_dupe <- subset(r3, !Q36B %in% c(8,9,-1))
# r3_dupe <- subset(r3, !Q36C %in% c(8,9,-1))
# 
# r2_dupe <- subset(r2, !Q35A %in% c(8,9,-1))
# r2_dupe <- subset(r2, !Q35C %in% c(8,9,-1))
# r2_dupe <- subset(r2, !Q35D %in% c(8,9,-1))
# 
# r1_dupe <- subset(r1, !rejone %in% c(8,9,-1))
# r1_dupe <- subset(r1, !rejmil %in% c(8,9,-1))
# r1_dupe <- subset(r1, !rejdic %in% c(8,9,-1))

# double check the excluded vals when using r1 r2 and r3

rejone_bk <- c(
               # mean(r1_dupe$Qrejone), mean(r2_dupe$Q35A), mean(r3_dupe$Q36A),
               mean(r4_dupe$Q29A), mean(r5_dupe$Q31A), mean(r6_dupe$Q28A), 
               mean(r7_dupe$Q27A), mean(r8_dupe$Q20A), mean(r9_dupe$Q22A))
rejmil_bk <- c(
               # mean(r1_dupe$Qremil), mean(r2_dupe$Q35C), mean(r3_dupe$Q36B),
               mean(r4_dupe$Q29B), mean(r5_dupe$Q31B), mean(r6_dupe$Q28B), 
               mean(r7_dupe$Q27B), mean(r8_dupe$Q20B), mean(r9_dupe$Q22B))
rejdic_bk <- c(
               # mean(r1_dupe$Qrejdic), mean(r2_dupe$Q35D), mean(r3_dupe$Q36C),
               mean(r4_dupe$Q29C), mean(r5_dupe$Q31C), mean(r6_dupe$Q28C), 
               mean(r7_dupe$Q27C), mean(r8_dupe$Q20C), mean(r9_dupe$Q22C))


rejone_df <- data.frame(Year = years, AverageResponse = rejone_bk)
rejone_df %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "sienna1") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Approval to One Party Rule Over Time in Burkina Faso",
       subtitle = "The y-axis scale is as follows: 1 is strongly disapprove, 2 is disapprove, 3 is neither, \n 4 is appprove, 5 is strongly approve")
rejmil_df <- data.frame(Year = years, AverageResponse = rejmil_bk)
rejmil_df %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "sienna1") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Approval to Military Rule Over Time in Burkina Faso",
       subtitle = "The y-axis scale is as follows: 1 is strongly disapprove, 2 is disapprove, 3 is neither, \n 4 is appprove, 5 is strongly approve")
rejdic_df <- data.frame(Year = years, AverageResponse = rejdic_bk)
rejdic_df %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "sienna1") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Approval to One Man Rule Over Time in Burkina Faso",
       subtitle = "The y-axis scale is as follows: 1 is strongly disapprove, 2 is disapprove, 3 is neither, \n 4 is appprove, 5 is strongly approve")
```

reject one party
- degree of disapproval generally increased as time passed, with a small rise in approval in 2018 and in 2022
reject military rule
- starts off near neither, disapproval increases, rises back to neutral and trends towards approve in most recent round
reject one man rule
- starts off near disapprove, degree of disapproval increases but increases at 2018 and in recent year (marking greatest average)


```{r}
# one stacked bar with disagree
# one stacked bar with agree
# percentage of responses



```

## support for democracy, extent of democracy, and satisfaction of democracy

```{r}
r9_dupe <- subset(r9, !Q23 %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q21 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q28 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q30 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q32 %in% c(8,9,-1))
r4_dupe <- subset(r4, !Q30 %in% c(8,9,-1))
# r3_dupe <- subset(r3, !Q37 %in% c(8,9,-1))
# r2_dupe <- subset(r2, !Q38 %in% c(8,9,-1))
# r1_dupe <- subset(r1, !supdem %in% c(8,9,-1))

# check

support <- c(# mean(r1_dupe$supdem), mean(r2_dupe$Q38), mean(r3_dupe$Q37),
             mean(r4_dupe$Q30), mean(r5_dupe$Q32), mean(r6_dupe$Q30), 
             mean(r7_dupe$Q28), mean(r8_dupe$Q21), mean(r9_dupe$Q23))
data.frame(Year = years, AverageResponse = support) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Support for Democracy Over Time in Burkina Faso",
       subtitle = "The y-axis scale is as follows: 1 is does not matter, 2 is sometimes non-democratic preferable, \n3 is democracy preferable")
  
```

starts off at 2.5, in between of preferring democracy and sometimes preferring nondemocratic
rising but decreased in 2018
at its lowest as of recent

for each wave
AFTER FILTERING VALUES
- get prop table
- entire prop table component as numeric into a new dataframe row
- plot that dataframe
```{r}
# stacked bar graph for each year



# support <= c(r4_dupe$Q30, r5_dupe$Q32, r6_dupe$Q30, 
#              r7_dupe$Q28, r8_dupe$Q21, r9_dupe$Q23)
# 
# wave4 = table(r4_dupe$Q30) / sum(table(r4_dupe$Q30))
# 
# df <- data.frame(Name=character(), one=integer(), two=double(), three=double())
# 
# 
# 
# data.frame(Year = years, AverageResponse = support) %>%
#   ggplot(aes(x = Year, y = AverageResponse)) +
#   geom_bar(stat = "identity", position = "fill") +
#   labs(x = "Afrobarometer Round Number & Year",
#        y = "Average Response",
#        title = "Average Response to Support for Democracy Over Time in Burkina Faso",
#        subtitle = "The y-axis scale is as follows: 1 is does not matter, 2 is sometimes non-democratic preferable, \n3 is democracy preferable")

```


```{r}
r9_dupe <- subset(r9, !Q30 %in% c(8,9,98,-1))
r8_dupe <- subset(r8, !Q36 %in% c(8,9,98,-1))
r7_dupe <- subset(r7, !Q35 %in% c(8,9,98,-1))
r6_dupe <- subset(r6, !Q40 %in% c(8,9,98,-1))
r5_dupe <- subset(r5, !Q42 %in% c(8,9,98,-1))
r4_dupe <- subset(r4, !Q42A %in% c(8,9,98,-1))
# r3_dupe <- subset(r3, !Q46 %in% c(8,9,-1))
# r2_dupe <- subset(r2, !Q37 %in% c(8,9,-1))
# r1_dupe <- subset(r1, !dmpext %in% c(8,9,-1))

extent <- c(# mean(r1_dupe$dmpext), mean(r2_dupe$Q37), mean(r3_dupe$Q46),
            mean(r4_dupe$Q42A), mean(r5_dupe$Q42), mean(r6_dupe$Q40), 
             mean(r7_dupe$Q35), mean(r8_dupe$Q36), mean(r9_dupe$Q30))
data.frame(Year = years, AverageResponse = extent) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Extent of Democracy Over Time in Burkina Faso",
       subtitle = "The y-axis scale is as follows: 1 is not a democracy, 2 is a democracy with major problems, \n3 is democracy with minor problems, 4 is full democracy")
```
starts off near 3 (democracy with minor problems) decreases until increase in 2018 but on downwards trend, 2022 marks lowest average perception of extent of democracy

```{r}
r9_dupe <- subset(r9, !Q31 %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q37 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q36 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q41 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q43 %in% c(8,9,-1))
r4_dupe <- subset(r4, !Q43 %in% c(8,9,-1))
# r3_dupe <- subset(r3, !Q47 %in% c(8,9,-1))
# r2_dupe <- subset(r2, !Q40 %in% c(8,9,-1))
# r1_dupe <- subset(r1, !dmpsat %in% c(8,9,-1))

satisfaction <- c(# mean(r1_dupe$dmpsat), mean(r2_dupe$Q40), mean(r3_dupe$Q47),
                  mean(r4_dupe$Q43), mean(r5_dupe$Q43), mean(r6_dupe$Q41), 
                  mean(r7_dupe$Q36), mean(r8_dupe$Q37), mean(r9_dupe$Q31))
data.frame(Year = years, AverageResponse = satisfaction) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Satisfaction for Democracy Over Time in Burkina Faso",
       subtitle = "The y-axis scale is as follows: 0 is not a democracy, 1 is not at all satisfied, 2 is not very satisfied, \n3 is fairly satified, 4 is very satisfied")

```

satisfaction decreases until small rise in 2018, but decreasing again, 2022 is lowest

## Govt gets things done vs. Govt accountable to citizens

```{r}
r9_dupe <- subset(r9, !Q18 %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q22 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q29 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q31 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q33 %in% c(8,9,-1))
# r4_dupe <- subset(r4, !Q43 %in% c(8,9,-1)) # question not in wave 4
# does not exist for r4 and previous waves

recode_statements <- function(data, col, recode_rules) {
  data[[col]] <- factor(data[[col]])
  data[[col]] <- fct_recode(data[[col]], !!!recode_rules)
  data[[col]] <- as.numeric(as.character(data[[col]]))
  return(data)
}

# adjustment made to ordering
# final ordering is as follows
# 1 - strongly agree with statement 1
# 2 - agree with statement 1
# 3 - agree with neither (neutral)
# 4 - agree with statement 2
# 5 - strongly agree with statement 2

statement_rules <- list(
  "1" = "1",
  "2" = "2",
  "4" = "3",
  "5" = "4",
  "3" = "5",
  "8" = "8",
  "9" = "9",
  "-1" = "-1")

r9_dupe <- recode_statements(r9_dupe, "Q18", statement_rules)
r8_dupe <- recode_statements(r8_dupe, "Q22", statement_rules)
r7_dupe <- recode_statements(r7_dupe, "Q29", statement_rules)
r6_dupe <- recode_statements(r6_dupe, "Q31", statement_rules)
r5_dupe <- recode_statements(r5_dupe, "Q33", statement_rules)


# subtitle = "Full Question: Question: Which of the following statements is closest to your view? \nStatement 1: It is more important to have a government that can get things done, even if we \nhave no influence over what it does. \nStatement 2: It is more important for citizens to be able to hold government accountable, even \nif that means it makes decisions more slowly."

govt <- c(mean(r5_dupe$Q33), mean(r6_dupe$Q31), 
          mean(r7_dupe$Q29), mean(r8_dupe$Q22), mean(r9_dupe$Q18))
govt

data.frame(Year = c("Round 5 (2012)", "Round 6 (2015)", "Round 7 (2018)", "Round 8 (2021)", "Round 9 (2022)"), AverageResponse = govt) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "seagreen") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to government gets things done (Statement 1) vs. \naccountable to citizens (Statement 2) Over Time in Burkina Faso",
       subtitle = "The y-axis scale is as follows: 1 is strongly agree with statement 1, 2 is agree with statement 1, \n3 is agree with neither, 4 is agree with statement 2, 5 is strongly agree with statement 2")

```
mostly neutral stance as average, small rise in 2015, but gradual decrease

## Choose leaders through elections vs. other methods


```{r}
r9_dupe <- subset(r9, !Q24 %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q24 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q30 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q32 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q34 %in% c(8,9,-1))
r4_dupe <- subset(r4, !Q31 %in% c(8,9,-1)) 
# r3_dupe <- subset(r3, !Q38 %in% c(8,9,-1))
# r2_dupe <- subset(r2, !Q30 %in% c(8,9,-1))
# does not exist for r1

recode_statements <- function(data, col, recode_rules) {
  data[[col]] <- factor(data[[col]])
  data[[col]] <- fct_recode(data[[col]], !!!recode_rules)
  data[[col]] <- as.numeric(as.character(data[[col]]))
  return(data)
}

# same adjustment made to ordering as prior graph

statement_rules <- list(
  "1" = "1",
  "2" = "2",
  "4" = "3",
  "5" = "4",
  "3" = "5",
  "8" = "8",
  "9" = "9",
  "-1" = "-1")

r9_dupe <- recode_statements(r9_dupe, "Q24", statement_rules)
r8_dupe <- recode_statements(r8_dupe, "Q24", statement_rules)
r7_dupe <- recode_statements(r7_dupe, "Q30", statement_rules)
r6_dupe <- recode_statements(r6_dupe, "Q32", statement_rules)
r5_dupe <- recode_statements(r5_dupe, "Q34", statement_rules)
r4_dupe <- recode_statements(r4_dupe, "Q31", statement_rules)
# r3_dupe <- recode_statements(r5_dupe, "Q38", statement_rules)
# r2_dupe <- recode_statements(r2_dupe, "Q30", statement_rules)

govt <- c(# mean(r2_dupe$Q30), mean(r3_dupe$Q38),
          mean(r4_dupe$Q31), mean(r5_dupe$Q34), mean(r6_dupe$Q32), 
          mean(r7_dupe$Q30), mean(r8_dupe$Q24), mean(r9_dupe$Q24))
govt

data.frame(Year = years, AverageResponse = govt) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "seagreen") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Choose leaders through elections (Statement 1) \nvs other methods (Statement 2) Over Time in Burkina Faso",
       subtitle = "The y-axis scale is as follows: 1 is strongly agree with statement 1, 2 is agree with statement 1, \n3 is agree with neither, 4 is agree with statement 2, 5 is strongly agree with statement 2")
```
starts off near agreement with statement 1, increasing sentiment towards statement 1 until 2018 goes towards neutral, highest tendency towards neutrality in 2022


## performance of president, trust president

```{r}
# r9_dupe <- subset(r9, !Q47A %in% c(8,9,-1)) # did not ask in Burkina Faso in most recent round
r8_dupe <- subset(r8, !Q51A %in% c(8,9,-1)) # 1 2 3 4 
r7_dupe <- subset(r7, !Q58A %in% c(8,9,-1)) # 1 2 3 4 
r6_dupe <- subset(r6, !Q68A_BFO %in% c(8,9,-1)) # 1 2 3 4 
r5_dupe <- subset(r5, !Q71A %in% c(8,9,-1)) # 1 2 3 4 
r4_dupe <- subset(r4, !Q70A %in% c(8,9,-1)) # 1 2 3 4
# r3_dupe <- subset(r3, !Q68A %in% c(8,9,-1))
# r2_dupe <- subset(r2, !Q48A %in% c(8,9,-1))
# r1_dupe <- subset(r1, !pfgpre %in% c(8,9,-1))

# 1=Strongly disapprove, 2=Disapprove, 3=Approve, 4=Strongly approve

perf <- c(# mean(r1_dupe$pfgpre), mean(r2_dupe$Q48A), mean(r3_dupe$Q68A),
             mean(r4_dupe$Q70A), mean(r5_dupe$Q71A), mean(r6_dupe$Q68A_BFO), 
             mean(r7_dupe$Q58A), mean(r8_dupe$Q51A))#, mean(r9_dupe$Q47A))
years1 <- c("Round 4 (2008)", "Round 5 (2012)", "Round 6 (2015)", "Round 7 (2018)", "Round 8 (2021)")

data.frame(Year = years1, AverageResponse = perf) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Performance of President in Burkina Faso Over Time",
       subtitle = "The y-axis scale is as follows: 1 is strongly disapprove, 2 is disapprove, 3 is approve,\n4 is strongly approve")
```

```{r}
r9_dupe <- subset(r9, !Q37A %in% c(8,9,-1))
r8_dupe <- subset(r8, !Q41A %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q43A %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q52A %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q59A %in% c(8,9,-1))
r4_dupe <- subset(r4, !Q49A %in% c(8,9,-1))
# r3_dupe <- subset(r3, !Q55A %in% c(8,9,-1))
# r2_dupe <- subset(r2, !Q43A %in% c(8,9,-1))
# r1_dupe <- subset(r1, !trspre %in% c(8,9,-1))

# 0=Not at all, 1=Just a little, 2=Somewhat, 3=A lot

trust <- c(# mean(r1_dupe$trspre), mean(r2_dupe$Q43A), mean(r3_dupe$Q55A),
             mean(r4_dupe$Q49A), mean(r5_dupe$Q59A), mean(r6_dupe$Q52A), 
             mean(r7_dupe$Q43A), mean(r8_dupe$Q41A), mean(r9_dupe$Q37A))
data.frame(Year = years, AverageResponse = trust) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Average Response",
       title = "Average Response to Trust in President in Burkina Faso Over Time",
       subtitle = "The y-axis scale is as follows: 0 is not at all, 1 is just a little, 2 is somewhat, 3 is a lot")
```
## voted in last election

```{r}
r9_dupe <- subset(r9, !Q13 %in% c(8,9,-1)) 
r8_dupe <- subset(r8, !Q13 %in% c(8,9,-1))
r7_dupe <- subset(r7, !Q22 %in% c(8,9,-1))
r6_dupe <- subset(r6, !Q21 %in% c(8,9,-1))
r5_dupe <- subset(r5, !Q27 %in% c(8,9,-1))
r4_dupe <- subset(r4, !Q23D %in% c(8,9,-1))
# r3_dupe <- subset(r3, !Q30 %in% c(8,9,-1))
# no r2 question equivalent
# r1_dupe <- subset(r1, !parvot %in% c(8,9,-1))

# 0=I did not vote, 1=I was too young to vote, 2=I can’t remember whether I voted, 3=I voted in
# the election
# for r8 and r9

perf <- c(# sum(r1_dupe$parvot == 1) / sum(r1_dupe$parvot), sum(r3_dupe$Q30 == 1) / sum(r3_dupe$Q30),
             (sum(r4_dupe$Q23D == 1) / length(r4_dupe$Q23D)), sum(r5_dupe$Q27 == 1) / length(r5_dupe$Q27), 
             sum(r6_dupe$Q21 == 1) / length(r6_dupe$Q21), sum(r7_dupe$Q22 == 1) / length(r7_dupe$Q22), 
             sum(r8_dupe$Q13 == 3) / length(r8_dupe$Q13), sum(r9_dupe$Q13 == 3) / length(r9_dupe$Q13))

data.frame(Year = years, AverageResponse = perf) %>%
  ggplot(aes(x = Year, y = AverageResponse)) +
  geom_bar(stat = "identity", fill = "skyblue") +
  labs(x = "Afrobarometer Round Number & Year",
       y = "Percentage of People",
       title = "Percentage of People Who Voted in the Last Election in Burkina Faso Over Time")

suppressMessages(ggsave("percent_vote_over_time.png", bg = "white", dpi=700))
```

# Most Recent Round, Wave 9 (2022)

## reject one party rule, military rule, one man rule
```{r, warning = FALSE}

# 1 = Strongly disapprove, 2 = Disapprove, 3 = Neither approve nor disapprove, 4 = Approve,
# 5 = Strongly approve, 8 = Refused, 9 = Don’t know, -1 = Missing

r9$Q22A <- factor(r9$Q22A)
r9$Q22B <- factor(r9$Q22B)
r9$Q22C <- factor(r9$Q22C)

r9$Q22A <- fct_recode(r9$Q22A, 
             "Strongly disapprove" = "1", 
             "Disapprove" = "2", 
             "Neither approve nor disapprove" = "3", 
             "Approve" = "4",
             "Strongly approve" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

r9$Q22B <- fct_recode(r9$Q22B,
             "Strongly disapprove" = "1", 
             "Disapprove" = "2", 
             "Neither approve nor disapprove" = "3", 
             "Approve" = "4",
             "Strongly approve" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

r9$Q22C <- fct_recode(r9$Q22C, 
             "Strongly disapprove" = "1", 
             "Disapprove" = "2", 
             "Neither approve nor disapprove" = "3", 
             "Approve" = "4",
             "Strongly approve" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q22A %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q22A)) +
  geom_bar(fill = "coral") +
  labs(x = "Scale of Approval",
       y = "Number of Responses",
       title = "Distribution of Responses to Approving/Disapproving One Party Rule in \nBurkina Faso 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_one_party_rule_approval.png", bg = "white", dpi=700))

subset(r9, !Q22B %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q22B)) +
  geom_bar(fill = "coral") +
  labs(x = "Scale of Approval",
       y = "Number of Responses",
       title = "Distribution of Responses to Approving/Disapproving Military Rule in \nBurkina Faso 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_military_rule_approval.png", bg = "white", dpi=700))

subset(r9, !Q22C %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q22C)) +
  geom_bar(fill = "coral") +
  labs(x = "Scale of Approval",
       y = "Number of Responses",
       title = "Distribution of Responses to Approving/Disapproving One Man Rule in \nBurkina Faso 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_one_man_rule_approval.png", bg = "white", dpi=700))

```

## support for democracy, extent of democracy, and satisfaction of democracy

```{r}
r9$Q23 <- factor(r9$Q23)
unique(r9$Q23)

r9$Q23 <- fct_recode(r9$Q23, 
             "Doesn’t matter" = "1", 
             "Sometimes non-democratic preferable" = "2", 
             "Democracy preferable" = "3", 
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q23 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q23)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Support for Democracy",
       y = "Number of Responses",
       title = "Distribution of Responses Towards Supporting Democracy in \nBurkina Faso 2022")

suppressMessages(ggsave("most_recent_support_democracy.png", bg = "white", dpi=700))

```

             
```{r}
r9$Q30 <- factor(r9$Q30)
unique(r9$Q30)

r9$Q30 <- fct_recode(r9$Q30,
             "Not a democracy" = "1",
             "Democracy, with major problems" = "2",
             "Democracy, but with minor problems" = "3",
             "Full democracy" = "4",
             "Do not understand question/what democracy is" = "8",
             "Don't Know" = "9",
             "Refused" = "98",
             "Missing" = "-1")

subset(r9, !Q30 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q30)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Extent of Democracy",
       y = "Number of Responses",
       title = "Distribution of Responses to the Extent of Democracy in Burkina Faso 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_democracy_extent.png", bg = "white", dpi=700))


```

```{r}
r9$Q31 <- factor(r9$Q31)
unique(r9$Q31)

r9$Q31 <- fct_recode(r9$Q31,
             "Not a democracy" = "0",
             "Not at all satisfied" = "1",
             "Not very satisfied" = "2",
             "Fairly satisfied" = "3",
             "Very satisfied" = "4",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q31 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q31)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Satisfaction of Democracy",
       y = "Number of Responses",
       title = "Distribution of Responses to Satisfaction of Democracy in Burkina Faso 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_democracy_satisfaction.png", bg = "white", dpi=700))

# 0= not a democracy, 1=Not at all satisfied, 2=Not very satisfied, 3=Fairly satisfied,
# 4=Very satisfied, 8=Refused, 9=Don’t know, -1=Missing
```

## Govt gets things done vs. Govt accountable to citizens

```{r}

r9$Q18 <- factor(r9$Q18)
unique(r9$Q18)

r9$Q18 <- fct_recode(r9$Q18,
             "Strongly agree with Statement 1" = "1", 
             "Agree with Statement 1" = "2", 
             "Agree with Statement 2" = "3",
             "Strongly agree with Statement 2" = "4",
             "Agree with neither" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q18 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q18)) +
  geom_bar(fill = "forestgreen") +
  labs(x = "Agreement to Statements",
       y = "Number of Responses",
       title = "Distribution of Responses to government gets things done (Statement 1) vs. \naccountable to citizens (Statement 2) in Burkina Faso 2022",
       subtitle = "Full Question: Question: Which of the following statements is closest to your view? \nStatement 1: It is more important to have a government that can get things done, even if we \nhave no influence over what it does. \nStatement 2: It is more important for citizens to be able to hold government accountable, even \nif that means it makes decisions more slowly.") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_govt.png", bg = "white", dpi=700))


# 1=Strongly agree with Statement 1, 2=Agree with Statement 1, 3=Agree with Statement 2,
# 4=Strongly agree with Statement 2, 5=Agree with neither, 8=Refused, 9=Don’t know, -1=Missing
```

## Choose leaders through elections vs. other methods

```{r}
r9$Q24 <- factor(r9$Q24)
unique(r9$Q24)

r9$Q24 <- fct_recode(r9$Q24,
             "Strongly agree with Statement 1" = "1", 
             "Agree with Statement 1" = "2", 
             "Agree with Statement 2" = "3",
             "Strongly agree with Statement 2" = "4",
             "Agree with neither" = "5",
             "Refused" = "8",
             "Don't Know" = "9",
             "Missing" = "-1")

subset(r9, !Q24 %in% c("Refused", "Don't Know", "Missing")) %>%
  ggplot(aes(x = Q24)) +
  geom_bar(fill = "forestgreen") +
  labs(x = "Agreement to Statements",
       y = "Number of Responses",
       title = "Distribution of Responses to Choose leaders through elections (Statement 1) \nvs other methods (Statement 2) in Burkina Faso 2022",
       subtitle = "Which of the following statements is closest to your view? \nStatement 1: We should choose our leaders in this country through regular, open and honest \nelections. \nStatement 2: Since elections sometimes produce bad results, we should adopt other methods for \nchoosing this country’s leaders.") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_leaders.png", bg = "white", dpi=700))

```
## performance of president 

```{r}
r8$Q51A <- factor(r8$Q51A)

r8$Q51A <- fct_recode(r8$Q51A,
             "Strongly disapprove" = "1", 
             "Disapprove" = "2", 
             "Approve" = "3",
             "Strongly approve" = "4",
             "Refused" = "8",
             "Don’t know/Haven’t heard enough" = "9",
             "Missing" = "-1")

subset(r8, !Q51A %in% c("Refused", "Don’t know/Haven’t heard enough", "Missing")) %>%
  ggplot(aes(x = Q51A)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Performance of President",
       y = "Number of Responses",
       title = "Distribution of Responses to Performance of President in Burkina Faso 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_president_performance.png", bg = "white", dpi=700))

```

## trust in president 

```{r}
r9$Q37A <- factor(r9$Q37A)

# 0=Not at all, 1=Just a little, 2=Somewhat, 3=A lot

r9$Q37A <- fct_recode(r9$Q37A,
             "Not at all" = "0",
             "Just a little" = "1",
             "Somewhat" = "2",
             "A lot" = "3",
             "Refused" = "8",
             "Don’t know/Haven’t heard enough" = "9",
             "Missing" = "-1")

subset(r9, !Q37A %in% c("Refused", "Don’t know/Haven’t heard enough", "Missing")) %>%
  ggplot(aes(x = Q37A)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Trust in President",
       y = "Number of Responses",
       title = "Distribution of Responses to Trust in President in Burkina Faso 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_president_trust.png", bg = "white", dpi=700))

```

## voted in last election

```{r}
r9$Q13 <- factor(r9$Q13)

r9$Q13 <- fct_recode(r9$Q13,
             "I did not vote" = "0",
             "I was too young to vote" = "1",
             "I can’t remember whether I voted" = "2",
             "I voted in the election" = "3",
             "Refused" = "8",
             "Don’t know" = "9",
             "Missing" = "-1")

subset(r9, !Q13 %in% c("Refused", "Don’t know", "Missing")) %>%
  ggplot(aes(x = Q13)) +
  geom_bar(fill = "cornflowerblue") +
  labs(x = "Trust in President",
       y = "Number of Responses",
       title = "Distribution of Responses to Voted in Last Election in Burkina Faso 2022") +
  scale_x_discrete(labels = function(x) str_wrap(x, width = 15)) 

suppressMessages(ggsave("most_recent_voted.png", bg = "white", dpi=700))

```

# not used

```{r, warning = FALSE}
recode_reject <- function(data, col, recode_rules) {
  data[[col]] <- factor(data[[col]])
  data[[col]] <- fct_recode(data[[col]], !!!recode_rules)
  return(data)
}

reject_rules <- list(
   "Strongly disapprove" = "1", 
   "Disapprove" = "2", 
   "Neither approve nor disapprove" = "3", 
   "Approve" = "4",
   "Strongly approve" = "5",
   "Refused" = "8",
   "Don't Know" = "9",
   "Missing" = "-1")

# r9 <- recode_reject(r9, "Q22A", reject_rules)
# r9 <- recode_reject(r9, "Q22B", reject_rules)
# r9 <- recode_reject(r9, "Q22C", reject_rules)

r8 <- recode_reject(r8, "Q20A", reject_rules)
r8 <- recode_reject(r8, "Q20B", reject_rules)
r8 <- recode_reject(r8, "Q20C", reject_rules)

r7 <- recode_reject(r7, "Q27A", reject_rules)
r7 <- recode_reject(r7, "Q27B", reject_rules)
r7 <- recode_reject(r7, "Q27C", reject_rules)

r6 <- recode_reject(r6, "Q28A", reject_rules)
r6 <- recode_reject(r6, "Q28B", reject_rules)
r6 <- recode_reject(r6, "Q28C", reject_rules)

r5 <- recode_reject(r5, "Q31A", reject_rules)
r5 <- recode_reject(r5, "Q31B", reject_rules)
r5 <- recode_reject(r5, "Q31C", reject_rules)

r4 <- recode_reject(r4, "Q29A", reject_rules)
r4 <- recode_reject(r4, "Q29B", reject_rules)
r4 <- recode_reject(r4, "Q29C", reject_rules)

# r3 <- recode_reject(r3, "Q36A", reject_rules)
# r3 <- recode_reject(r3, "Q36B", reject_rules)
# r3 <- recode_reject(r3, "Q36C", reject_rules)
# 
# r2 <- recode_reject(r2, "Q35A", reject_rules)
# r2 <- recode_reject(r2, "Q35C", reject_rules)
# r2 <- recode_reject(r2, "Q35D", reject_rules)
# 
# r1 <- recode_reject(r1, "rejone", reject_rules)
# r1 <- recode_reject(r1, "rejmil", reject_rules)
# r1 <- recode_reject(r1, "rejdic", reject_rules)
```


